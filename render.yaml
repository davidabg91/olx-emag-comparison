services:
  - type: web
    name: olx-emag-comparison
    env: python
    buildCommand: |
      apt-get update && apt-get install -y wget unzip
      mkdir -p /opt/chrome
      wget -q "https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/114.0.5735.90/linux64/chrome-linux64.zip"
      unzip chrome-linux64.zip
      mv chrome-linux64/chrome /opt/chrome/google-chrome
      chmod +x /opt/chrome/google-chrome
      rm -rf chrome-linux64.zip chrome-linux64
      wget -q "https://edgedl.me.gvt1.com/edgedl/chrome/chrome-for-testing/114.0.5735.90/linux64/chromedriver-linux64.zip"
      unzip chromedriver-linux64.zip
      mv chromedriver-linux64/chromedriver /opt/chrome/chromedriver
      chmod +x /opt/chrome/chromedriver
      rm -rf chromedriver-linux64.zip chromedriver-linux64
      echo 'export PATH="/opt/chrome:$PATH"' >> /etc/profile
      echo 'export PATH="/opt/chrome:$PATH"' >> ~/.bashrc
      export PATH="/opt/chrome:$PATH"
      pip install -r requirements.txt
      echo "Проверка на Chrome:"
      /opt/chrome/google-chrome --version
      echo "Проверка на ChromeDriver:"
      /opt/chrome/chromedriver --version
    startCommand: gunicorn app:app
    envVars:
      - key: PYTHON_VERSION
        value: 3.9.0
      - key: PORT
        value: 10000
      - key: PYTHONUNBUFFERED
        value: "1"
      - key: PATH
        value: "/opt/chrome:$PATH" 